unit uDadosPessoa;

interface

uses
  System.SysUtils;

  type
    TipoDadosPessoa = record
      Altura: Double;
      Peso: Double;
      Sexo: String;
      IMC: String;
    end;

    function CalcularIMC(PessoaPeso, PessoaAltura: Double; PessoaSexo: String): String;

    var
      Pessoa : TipoDadosPessoa;

implementation

function CalcularIMC(PessoaPeso, PessoaAltura: Double; PessoaSexo: String): String;
var
  numIMC: Double;
  strIMC: String;

begin

  if PessoaSexo = '' then
  raise  Exception.Create('Obrigatório informar o sexo');

  try
    numIMC := PessoaPeso / (PessoaAltura * PessoaAltura);

    if PessoaSexo = 'Feminino' then
    begin
      if numIMC < 19 then
      begin
        strIMC := 'Abaixo do normal';
      end;

      if (numIMC >= 19) and (numIMC < 23.9) then
      begin
        strIMC := 'Normal';
      end;

      if (numIMC >= 23.9) and (numIMC < 28.9) then
      begin
        strIMC := 'Obesidade leve';
      end;

      if (numIMC >= 28.9) and (numIMC < 38.9) then
      begin
        strIMC := 'Obesidade moderada';
      end;

      if (numIMC >= 38.9) then
      begin
        strIMC := 'Obesidade mórbida';
      end;

    end;

     if PessoaSexo = 'Masculino' then
    begin
      if numIMC < 20 then
      begin
        strIMC := 'Abaixo do normal';
      end;

      if (numIMC >= 20) and (numIMC < 24.9) then
      begin
        strIMC := 'Normal';
      end;

      if (numIMC >= 24.9) and (numIMC < 29.9) then
      begin
        strIMC := 'Obesidade leve';
      end;

      if (numIMC >= 29.9) and (numIMC < 39.9) then
      begin
        strIMC := 'Obesidade moderada';
      end;

      if (numIMC >= 39.9) then
      begin
        strIMC := 'Obesidade mórbida';
      end;

    end;
    Result :=  strIMC;

  except
    raise Exception.Create('Erro ao efetuar o cálculo');
  end;


end;


end.
